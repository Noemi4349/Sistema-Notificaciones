<!-- excel.component.html mejorado sin cambiar tu estructura original -->
<div class="excel-wrapper">

  <!-- ENCABEZADO SIMPLE (manteniendo tu estilo original) -->
  <h2 class="section-title">Enviar Mensajes a Socios </h2>
  <p class="subtitle">Cargando un Archivo Excel</p>

  <!-- CARD DE SUBIDA -->
  <div class="card upload-card">
    <div class="upload-area" (click)="fileInput.click()">
      <i class="pi pi-upload upload-icon"></i>
      <p class="upload-text">Selecciona un archivo Excel</p>
      <input #fileInput type="file" (change)="onFileSelected($event)" hidden />
    </div>

    <p class="file-name" *ngIf="fileName">Archivo seleccionado: {{ fileName }}</p>
  </div>

  <!-- Vista previa de Excel -->
<div class="card mt-4" *ngIf="excelData.length > 0">
  <h3 class="section-title">Vista previa del archivo</h3>

  <p-table [value]="excelData" responsiveLayout="scroll">
    <ng-template pTemplate="header">
      <tr>
        <th>Nro Socio</th>
        <th>Nombre</th>
        <th>Teléfono</th>
        <th>Valido</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-row>
      <tr>
        <td>{{ row.numeroSocio }}</td>
        <td>{{ row.nombres }}</td>
        <td>{{ row.numeroTelefono }}</td>
        <td>
          <span [ngClass]="row.valido ? 'text-green-600' : 'text-red-600'">
            {{ row.valido ? '✓' : '✗' }}
          </span>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>


  <!-- CARD DEL MENSAJE -->
  <div class="card message-card mt-4">
    <h3 class="section-title">Mensaje</h3>

    <textarea [(ngModel)]="mensaje" class="message-box" placeholder="Escribe tu mensaje..."></textarea>

    <div class="button-row mt-2">
      <button pButton label="Guardar" class="p-button-primary" (click)="guardarMensaje()"></button>
      <button pButton label="Cancelar" class="p-button-secondary" (click)="cancelarMensaje()"></button>
    </div>
  </div>

  <!-- Botón de envío -->
  <button 
    pButton 
    label="Enviar Mensaje" 
    class="mt-4"
    icon="pi pi-send"
    [disabled]="mensaje.length === 0 || excelData.length === 0"
    (click)="enviarMensajes()">
  </button>

</div>
